#Install Logstash
sudo apt-get install logstash

#Install Additional Plugin (This step can take a while be patient)
 cd /usr/share/logstash/bin/
./logstash-plugin install logstash-filter-translate

#Copy or Create .csv files for application and category searching
/user/local/share/

#Copy config file to pem-stash.conf or create new file
Directory /etc/logstash/conf.d/ 

Contents:

input {
    tcp {
        port => 5514
    }
}
filter {
    kv {
      source => "message"
      field_split => ","
    }
    geoip {
      source => "dest_ip"
    }
    translate {
      field => "application_category_id"
      destination => "application_category_name"
      dictionary_path => '/usr/local/share/signatures.csv'
    }
    translate {
      field => "url_category_id"
      destination => "url_category_name"
      dictionary_path => '/usr/local/share/categories.csv'
}
}
output {
    stdout {}
    elasticsearch {
      hosts => ["localhost:9200"]
      index    => "pem-%{+YYYY.MM.dd}"
      template_name => "pem"
    }
}


#Logstash restart
sudo systemctl restart logstash.service

#To configure Logstash to start automatically when the system boots up, run the following commands:
sudo /bin/systemctl daemon-reload
sudo /bin/systemctl enable logstash.service

#Logstash Control
sudo systemctl start logstash.service
sudo systemctl stop logstash.service
sudo systemctl status logstash.service
